<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="Author" content="Lee">
    <meta name="Keywords" content="后台模板">
    <title></title>
    <link rel="stylesheet" href="./css/layui.css">
    <link rel="stylesheet" href="./css/public.css" />
    <script src="./layui.js"></script>
</head>
<style>

</style>

<body style="overflow-y:hidden">
    <div class="layui-layout layui-layout-admin">
        <div class="layui-header">
            <div class="layui-logo">后台模板</div>

            <ul class="layui-nav layui-layout-right">
                <li class="layui-nav-item">
                    <a href="javascript:;">
                        <img src="http://t.cn/RCzsdCq" class="layui-nav-img"> 贤心
                    </a>
                    <dl class="layui-nav-child">
                        <dd><a href="">退出</a></dd>

                    </dl>

                </li>


            </ul>
        </div>

        <!-- 侧边栏 -->
        <div class="layui-side layui-bg-black">
            <div class="layui-side-scroll">
                <div title="菜单缩放" class="kit-side-fold layui-nav-item layui-nav-itemed" style="height:45px;text-align: center"><i class="layui-icon layui-icon-shrink-right" aria-hidden="true" style="font-size: 30px"></i></div>
                <!-- <img src="./images/avator.png" class="user_img" />
                <h1 class="user_name">你好！Lee,欢迎登陆</h1> -->
                <ul class="layui-nav layui-nav-tree" lay-filter="left-nav">
                    <li class="layui-nav-item">
                        <!-- layui-nav-itemed-->
                        <a href="javascript:;" data-id="0" data-url="./blog.html" class="left_nav" id="box"><i class="layui-icon">&#xe66e;</i>博客</a>

                    </li>
                    <li class="layui-nav-item">
                        <!-- layui-nav-itemed-->
                        <a href="javascript:;"><i class="layui-icon">&#xe66f;</i>个人博客</a>
                        <dl class="layui-nav-child">
                            <dd><a href="javascript:;" data-id="1" data-url="./blog_editor.html" class="left_nav"><i class="layui-icon">&#xe655;</i>新建博客</a></dd>
                            <dd><a href="javascript:;" data-id="2" data-url="./person_blog_draft.html" class="left_nav"><i class="layui-icon">&#xe705;</i>草稿箱</a></dd>
                            <dd><a href="javascript:;" data-id="3" data-url="./person_blog_history.html" class="left_nav"><i class="layui-icon">&#xe6b2;</i>博客管理</a></dd>
                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;"><i class="layui-icon">&#xe667;</i>新闻管理</a>
                        <dl class="layui-nav-child">
                            <dd><a href="javascript:;" data-id="4" data-url="./editor.html" class="left_nav"><i class="layui-icon">&#xe655;</i>新建新闻</a></dd>
                            <dd><a href="javascript:;" data-id="5" data-url="./message.html" class="left_nav"><i class="layui-icon">&#xe705;</i>草稿箱</a></dd>
                            <dd><a href="javascript:;" data-id="6" data-url="./message_history.html" class="left_nav"><i class="layui-icon">&#xe6b2;</i>新闻管理</a></dd>
                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;"><i class="layui-icon">&#xe62e;</i>项目管理</a>
                        <dl class="layui-nav-child">
                            <dd><a href="javascript:;" data-id="7" data-url="./project_editor.html" class="left_nav"><i class="layui-icon">&#xe655;</i>新建项目</a></dd>
                            <dd><a href="javascript:;" data-id="8" data-url="./project_message.html" class="left_nav"><i class="layui-icon">&#xe705;</i>草稿箱</a></dd>
                            <dd><a href="javascript:;" data-id="9" data-url="./project_message_history.html" class="left_nav"><i class="layui-icon">&#xe6b2;</i>项目管理</a></dd>
                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;" data-id="14" data-url="./group_leader.html" class="left_nav"><i class="layui-icon">&#xe655;</i>组长审核</a></dd>

                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;"><i class="layui-icon">&#xe612;</i>成员管理</a>
                        <dl class="layui-nav-child">
                            <dd><a href="javascript:;" data-url="./graduate.html" data-id="10" class="left_nav"><i class="layui-icon">&#xe6b2;</i>成员管理</a></dd>

                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;"><i class="layui-icon">&#xe63c;</i>组别管理</a>
                        <dl class="layui-nav-child">
                            <dd><a href="javascript:;" data-url="./group.html" data-id="11" class="left_nav"><i class="layui-icon">&#xe6b2;</i>组别管理</a></dd>

                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;"><i class="layui-icon">&#xe60a;</i>标签管理</a>
                        <dl class="layui-nav-child">
                            <dd><a href="javascript:;" data-url="./classify.html" data-id="12" class="left_nav"><i class="layui-icon">&#xe6b2;</i>标签管理</a></dd>

                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;"><i class="layui-icon">&#xe770;</i>毕业生管理</a>
                        <dl class="layui-nav-child">
                            <dd><a href="javascript:;" data-url="./lab_graduate.html" data-id="13" class="left_nav"><i class="layui-icon">&#xe60e;</i>毕业生管理</a></dd>
                        </dl>
                    </li>


                </ul>
            </div>
        </div>
        <!-- 主体 -->
        <div class="layui-body" style="background:f5f6f7">
            <!-- 顶部切换卡 -->
            <div class="layui-tab layui-tab-brief" lay-filter="top-tab" lay-allowClose="true" style="margin: 0;">
                <ul class="layui-tab-title">

                </ul>
                <div class="layui-tab-content" style="padding: 0;">

                </div>
            </div>
            <h1 class="admin_title">
                后台
            </h1>
        </div>
        <!-- 底部 -->
        <!--        <div class="layui-footer" style="text-align: center; line-height: 44px;">
           	asdasd
        </div>-->
    </div>


    <script type="text/javascript">
        var active;
        layui.use(['layer', 'element'], function() {

            var element = layui.element;
            var layer = layui.layer;
            var $ = layui.jquery;
            var isShow = true; //定义一个标志位
            $('.kit-side-fold').click(function() {
                //选择出所有的span，并判断是不是hidden
                $('.layui-nav-item span').each(function() {
                    if ($(this).is(':hidden')) {
                        $(this).show();
                    } else {
                        $(this).hide();
                    }
                });
                //判断isshow的状态
                if (isShow) {
                    $('.layui-side.layui-bg-black').width(60); //设置宽度
                    $('.kit-side-fold i').css('margin-right', '70%'); //修改图标的位置
                    //将footer和body的宽度修改
                    $('.layui-body').css('left', 60 + 'px');
                    $('.layui-footer').css('left', 60 + 'px');
                    //将二级导航栏隐藏
                    $('dd span').each(function() {
                        $(this).hide();
                    });
                    //修改标志位
                    isShow = false;
                } else {
                    $('.layui-side.layui-bg-black').width(200);
                    $('.kit-side-fold i').css('margin-right', '10%');
                    $('.layui-body').css('left', 200 + 'px');
                    $('.layui-footer').css('left', 200 + 'px');
                    $('dd span').each(function() {
                        $(this).show();
                    });
                    isShow = true;
                }
            });

            var navfilter = 'left-nav';
            var nav = $('.layui-nav[lay-filter=' + navfilter + ']').eq(0);
            var tabfilter = 'top-tab';
            var tab = $('.layui-tab[lay-filter=' + tabfilter + ']').eq(0);
            var tabcontent = tab.children('.layui-tab-content').eq(0);
            var tabtitle = tab.children('.layui-tab-title').eq(0);

            /**
             * 监听侧边栏导航点击事件
             */
            active = {
                tabAdd: function(url, id, text) {
                    //新增一个Tab项
                    element.tabAdd('top-tab', {
                        title: text //用于演示
                            ,
                        content: '<iframe id="' + id + '" data-frameid="' + id + '" frameborder="0" name="content" scrolling="yes" width="100%" src="' + url + '"></iframe>',
                        id: id //实际使用一般是规定好的id，这里以时间戳模拟下
                    });
                    FrameWH()


                },
                tabChange: function(id) {
                    element.tabChange('top-tab', id); //切换到：用户管理
                    $("iframe[data-frameid='" + id + "']").attr("src", $("iframe[data-frameid='" + id + "']").attr("src")) //切换后刷新框架
                },
                tabDelete: function(id) {
                    element.tabDelete("top-tab", id); //删除
                },
                tabDeleteAll: function(ids) { //删除所有
                    $.each(ids, function(i, item) {
                        element.tabDelete("top-tab", item);
                    })
                },

            };

            function changeIframeHeight() {
                $('iframe').height = $(window).height() - 110 + 'px'
            }
            window.onresize = function() {
                changeIframeHeight()
            }

            function FrameWH() {
                var h = $(window).height();

                h = h - 110;
                console.log(h)
                $("iframe").css("height", h + "px");
            }
            Top_tab();

            function Top_tab() {
                element.on('tab(top-tab)', function(data) {
                    $('.layui-tab').show();
                    $('.admin_title').hide();
                    // $('.layui-progress-bar').fadeOut();
                    // element.progress('progress', '0%');

                    var _index = data.index;
                    console.log(_index)
                    $('iframe').stop().animate({
                        opacity: 0,
                        top: '30px'
                    }, 300);
                    $('iframe').eq(_index).animate({
                        opacity: 1,
                        top: 0
                    }, 300);
                    // $('iframe').eq(_index).load(function() {
                    //     $('.layui-progress-bar').fadeIn();
                    //     element.progress('progress', '100%');
                    //     $('.layui-progress-bar').fadeOut(20);
                    // })
                });
                element.on('tabDelete(top-tab)', function(data) {
                    console.log(tabtitle.find('li').length);
                    if (tabtitle.find('li').length < 1) {
                        $('#box').trigger("click");
                    }
                });
            }

            $(".left_nav").click(function() {
                var dataid = $(this);
                if ($(".layui-tab-title li[lay-id]").length <= 0) {
                    active.tabAdd(dataid.attr("data-url"), dataid.attr("data-id"), dataid.html());
                    console.log($(".layui-tab-title li[lay-id]"))

                } else {
                    var isData = false;
                    $.each($(".layui-tab-title li[lay-id]"), function() {
                        if ($(this).attr("lay-id") == dataid.attr("data-id")) {
                            isData = true;
                        }
                    })
                    if (isData == false) {
                        active.tabAdd(dataid.attr("data-url"), dataid.attr("data-id"), dataid.html());

                    }
                }
                active.tabChange(dataid.attr("data-id"));
            })
            $('#box').trigger("click");
            document.addEventListener('keydown', function(e) { //锁屏监听alt+l
                if (e.keyCode == 76 && 18) {
                    $('.logo_shard').fadeIn();
                }
            })
            $('.user_img').click(function() {
                layer.open({
                    anim: 5,
                    title: "更换头像",
                    area: ['500px', '500px'],
                    type: 2,
                    content: 'drawImg.html' //这里content是一个URL，如果你不想让iframe出现滚动条，你还可以content: ['http://sentsin.com', 'no']
                });

            })



        });

        function imgAttr(url) {
            document.getElementsByClassName('user_img')[0].setAttribute('src', url);
            layui.use('layer', function() {
                var layer = layui.layer;
                layer.msg('更换成功');
            })
        }
    </script>
</body>

</html>